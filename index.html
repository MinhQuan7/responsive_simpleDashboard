<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Energy Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="assest/styles.css" />
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="name-company">E-Ra IoT Platform</div>
    <img src="assest/img/eoh.png" alt="Company Logo" class="company-logo" />
    <div class="device-number">Since by 2021</div>
  </header>

  <div class="dashboard-container">
    <!-- Năng lượng blocks -->
    <!-- <section class="left-column"> -->
    <div class="energy-grid">
      <!-- Hàng 1 -->
      <div class="energy-block pv-energy">
        <div class="header-box pv-text">
          <h3>Dòng Điện</h3>
        </div>
        <div class="energy-content">
          <div class="current">
            Sản lượng hôm nay
            <div class="value-unit">
              <h3 id="currentId"></h3>
              <h3 class="unit">A</h3>
            </div>
          </div>
        </div>
        <div class="energy-icon">
          <img src="assest/img/power.png" alt="PV Icon" />
        </div>
      </div>

      <div class="energy-block discharge-energy">
        <div class="header-box discharge-text">
          <h3>Điện Áp</h3>
        </div>
        <div class="energy-content">
          <div class="voltage">
            Xả hôm nay
            <div class="value-unit">
              <h3 id="voltageId"></h3>
              <h3 class="unit">V</h3>
            </div>
          </div>
        </div>
        <div class="energy-icon">
          <img src="assest/img/powerloss.png" alt="Discharge Icon" />
        </div>
      </div>

      <!-- Hàng 2 -->
      <div class="energy-block charge-energy">
        <div class="header-box charge-header">
          <h3>Công suất tức thời</h3>
        </div>
        <div class="energy-content">
          <p>Đẩy lưới hôm nay</p>
          <div class="value-unit">
            <h3 class="power">0</h3>
            <h3 class="unit">kWh</h3>
          </div>
        </div>
        <div class="energy-icon">
          <img src="assest/img/solar.png" alt="" />
        </div>
      </div>

      <div class="energy-block grid-energy">
        <div class="header-box grid-header">
          <div class="powerConsumption">
            <h3>Công suất tiêu thụ</h3>
          </div>
        </div>
        <div class="energy-content">
          <p>Tiêu thụ hôm nay</p>
          <div class="value-unit">
            <h3 id="Power"></h3>
            <h3 class="unit">kWh</h3>
          </div>
        </div>
        <div class="energy-icon">
          <img src="assest/img/onoff.png" alt="" />
        </div>
      </div>
    </div>


    <!-- Sơ đồ năng lượng -->
    <section class="energy-diagram">
      <!-- Icons và hình ảnh sẽ được chèn tại đây -->
      <div class="container">
        <!-- Solar Panel -->
        <div class="solar-section">
          <img src="assest/img/stationTrans.png" alt="stationTrans" />
          <div>
            <div class="value">7202W</div>
            <div class="label">Công suất PV</div>
          </div>
        </div>

        <!-- Battery -->
        <div class="battery-section">
          <img src="assest/img/weatherStation.png" alt="weatherStation" />
          <div class="value">5733W</div>
          <div class="label">Công suất sạc</div>
          <div class="value">55.2Vdc</div>
          <div class="label">87% Dung lượng ắc quy</div>
        </div>

        <!-- Status -->
        <div class="status">
          <div class="status-dot"></div>
          <span>Normal</span>
        </div>

        <!-- Inverter -->
        <div class="inverter-section">
          <img src="assest/img/cabinet.png" alt="cabinet" />
        </div>

        <!-- Status Text -->
        <div class="status-section">
          <div class="value">Trạm trung truyển</div>
        </div>

        <!-- Grid -->
        <div class="grid-section">
          <img src="assest/img/home.png" alt="homePower" />
          <div class="value">219.9Vac</div>
          <div class="label">50.18Hz</div>
          <div class="value">0W</div>
        </div>

        <!-- Consumption -->
        <div class="consumption-section">
          <img src="assest/img/iphone.png" alt="" />
          <div class="value">1273W</div>
          <div class="label">Tiêu thụ</div>
        </div>

        <!-- Timestamp -->
        <div class="clock-container">
          <div class="clock" id="clock"></div>
        </div>

        <!-- Connection Lines -->
        <div class="connection-lines">
          <!-- Left side connection -->
          <div class="line line-horizontal line-arrow line-left"></div>
          <!-- Right side connection -->
          <div class="line line-horizontal line-dashed line-right line-arrow"></div>
          <!-- Status line -->
          <div class="line line-vertical line-status line-arrow-vertical"></div>
          <!-- Đường line -->
          <div class="line line-horizontal line-pv-to-status line-arrow"></div>
          <!-- Đường line dọc xuống Trạm trung tuyên -->
          <div class="line line-vertical line-pv-to-status-vertical line-arrow-vertical-bottom"></div>
        </div>
      </div>
    </section>

    <!-- Thông tin bổ sung -->
    <section class="additional-info">
      <button class="quick-charge">Start Quick Charge</button>
      <div class="info-block">
        <span>6kW Power rating</span>
      </div>
      <div class="info-block">
        <span>Firmware version: cbaa-181B18</span>
      </div>
      <div class="info-block">
        <span>Batt Parallel Num: 0</span>
      </div>
      <div class="info-block"><span> Batt Capacity: 100Ah </span></div>
    </section>
  </div>

  <script src="https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js"></script>

  <script>
    const current = document.getElementById("currentId"); // ID chuỗi cho dòng điện
    const voltage = document.getElementById("voltageId"); // ID chuỗi cho điện áp
    const pw = document.getElementById("Power"); // ID số cho công suất tiêu thụ

    let configCurrent = null,
      configVol = null,
      configPower = null;

    const eraWidget = new EraWidget();

    eraWidget.init({
      onConfiguration: (configuration) => {
        // Lưu các cấu hình khi nhận được từ widget
        configCurrent = configuration.realtime_configs[0]; // Lưu cấu hình dòng điện
        configVol = configuration.realtime_configs[1]; // Lưu cấu hình điện áp
        configPower = configuration.realtime_configs[2]; // Lưu cấu hình power
      },

      // Hàm lấy giá trị từ các ID và cập nhật giao diện
      onValues: (values) => {
        const voltageVal = values[configVol.id].value;
        const currentVal = values[configCurrent.id].value;
        const powerVal = values[configPower.id].value;

        current.innerHTML = currentVal;
        voltage.innerHTML = voltageVal
        pw.innerHTML = powerVal;

      },
    });

  </script>
  <script src="script.js"></script>
</body>

</html>